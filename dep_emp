CREATE TABLE DEPT (
  DEPTNO NUMBER PRIMARY KEY,
  DNAME  VARCHAR2(50),
  LOCATION VARCHAR2(50)
);

CREATE TABLE EMP (
  EMPNO   NUMBER PRIMARY KEY,
  ENAME   VARCHAR2(100),
  JOB     VARCHAR2(50),
  HIREDATE DATE,
  SALARY  NUMBER,
  DEPTNO  NUMBER,
  CONSTRAINT fk_emp_dept FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);


ALTER TABLE DEPT ADD CONSTRAINT pk_dept PRIMARY KEY (DEPTNO);

ALTER TABLE EMP ADD CONSTRAINT pk_emp PRIMARY KEY (EMPNO);

ALTER TABLE EMP ADD CONSTRAINT fk_emp_dept FOREIGN KEY (DEPTNO)
REFERENCES DEPT(DEPTNO);

SELECT DEPTNO, MAX(SALARY) AS max_salary
FROM EMP
GROUP BY DEPTNO;

SELECT * FROM EMP WHERE DEPTNO IN (10, 20);

SELECT ename, salary FROM emp
WHERE UPPER(SUBSTR(ename,3,1)) = 'A';

SELECT deptno, AVG(salary) avg_salary
FROM emp
GROUP BY deptno
HAVING AVG(salary) > 2000;

SELECT ename FROM emp WHERE UPPER(SUBSTR(ename,-1,1)) = 'S';
